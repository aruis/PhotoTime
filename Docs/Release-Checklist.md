# PhotoTime Release Checklist

适用范围：发布前分支（`main`）准备阶段。  
目标：在发版前收口权限、磁盘、兼容性、失败恢复链路的关键风险。

## 1. 自动化门禁（必须通过）

执行：

```bash
./scripts/release-gate.sh
```

通过标准：

- `MACOSX_DEPLOYMENT_TARGET` 与基线一致（14.6）。
- CI 工作流仍包含三类质量门：`Non-UI Tests`、`Audio Regression`、`UI Smoke`。
- CI 使用 `setup-xcode` 且 `xcode-version: latest-stable`。
- 本地质量门 `./scripts/test-ci-gate.sh` 全绿。

## 2. 手工检查（发布责任人确认）

1. 权限链路
- 首次导入素材时可正常选择并读取文件。
- 导出到用户目录（如“影片”）可成功写入。
- 权限拒绝场景出现友好提示，且可引导用户恢复（重试/重新选择素材）。

2. 磁盘与路径链路
- 在可写目录导出成功，输出文件与日志文件均可定位。
- 不可写/空间不足场景下，失败信息包含明确建议动作。

3. 兼容性链路
- 在目标最低系统版本（macOS 14.6）验证主路径：导入 -> 预览 -> 导出。
- 导入模板（旧版本模板）与导出模板回环行为正常。

4. 失败恢复链路
- 导出失败后能看到：错误头、建议动作、日志路径、问题素材定位信息。
- “重试上次导出”与“重新选择素材”动作符合预期。

## 3. 发布留档（建议）

- 保留一份最新 `CI` 通过链接。
- 若发布前出现失败，执行：

```bash
./scripts/collect-diagnostics.sh
```

将打包结果（`.tar.gz`）附到排障记录中。
